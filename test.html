<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PWA Test Page - Zopollo IT</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@300;400;500;600;700&family=Orbitron:wght@500;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Overlay -->
    <div class="overlay" id="overlay"></div>

    <!-- Navigation Sidebar -->
    <nav class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="logo">
                <svg width="200" height="60" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 60">
                    <defs>
                        <linearGradient id="logoGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#0066ff;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#00f0ff;stop-opacity:1" />
                        </linearGradient>
                    </defs>
                    <!-- Z Icon -->
                    <g transform="translate(5, 15)">
                        <path d="M 0,0 L 25,0 L 0,30 L 25,30"
                              stroke="url(#logoGradient)"
                              stroke-width="3"
                              fill="none"
                              stroke-linecap="round"
                              stroke-linejoin="round"/>
                        <circle cx="0" cy="0" r="2.5" fill="url(#logoGradient)"/>
                        <circle cx="25" cy="0" r="2.5" fill="url(#logoGradient)"/>
                        <circle cx="0" cy="30" r="2.5" fill="url(#logoGradient)"/>
                        <circle cx="25" cy="30" r="2.5" fill="url(#logoGradient)"/>
                        <circle cx="12.5" cy="15" r="3" fill="url(#logoGradient)"/>
                    </g>
                    <!-- Text -->
                    <text x="40" y="28"
                          font-family="Orbitron, monospace"
                          font-size="20"
                          font-weight="900"
                          fill="url(#logoGradient)">ZOPOLLO</text>
                    <text x="40" y="45"
                          font-family="Orbitron, monospace"
                          font-size="14"
                          font-weight="500"
                          fill="#00f0ff"
                          letter-spacing="2">IT</text>
                </svg>
            </div>
            <button class="close-btn" id="closeBtn" aria-label="Close menu">&times;</button>
        </div>

        <ul class="nav-menu">
            <li class="nav-item">
                <a href="index.php#home" class="nav-link">
                    <span class="nav-icon">ğŸ </span>
                    Home
                </a>
            </li>
            <li class="nav-item">
                <a href="index.php#services" class="nav-link">
                    <span class="nav-icon">ğŸ› ï¸</span>
                    Services
                </a>
            </li>
            <li class="nav-item">
                <a href="index.php#support" class="nav-link">
                    <span class="nav-icon">ğŸ«</span>
                    Submit Ticket
                </a>
            </li>
            <li class="nav-item">
                <a href="view_tickets.php" class="nav-link">
                    <span class="nav-icon">ğŸ“‹</span>
                    View Tickets
                </a>
            </li>
            <li class="nav-item">
                <a href="index.php#status" class="nav-link">
                    <span class="nav-icon">ğŸ“Š</span>
                    System Status
                </a>
            </li>
            <li class="nav-item">
                <a href="index.php#knowledge" class="nav-link">
                    <span class="nav-icon">ğŸ“š</span>
                    Knowledge Base
                </a>
            </li>
            <li class="nav-item">
                <a href="index.php#contact" class="nav-link">
                    <span class="nav-icon">ğŸ“§</span>
                    Contact Us
                </a>
            </li>
        </ul>

        <div class="sidebar-footer">
            <div class="contact-info">
                <p><strong>24/7 Support Hotline</strong></p>
                <p><a href="tel:+1234567890">+1 (234) 567-890</a></p>
                <p><a href="mailto:support@zopollo.com">support@zopollo.com</a></p>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Header -->
        <header class="header">
            <div class="header-logo">
                <button class="hamburger" id="hamburger" aria-label="Open menu">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
                <img src="zopollo-logo-compact.svg" alt="Zopollo IT">
            </div>

            <!-- Desktop Navigation -->
            <nav class="desktop-nav">
                <a href="index.php#home">ğŸ  Home</a>
                <a href="index.php#services">ğŸ› ï¸ Services</a>
                <a href="index.php#support">ğŸ« Submit Ticket</a>
                <a href="view_tickets.php">ğŸ“‹ View Tickets</a>
                <a href="index.php#status">ğŸ“Š Status</a>
                <a href="index.php#knowledge">ğŸ“š Knowledge</a>
                <a href="index.php#contact">ğŸ“§ Contact</a>
            </nav>

            <div class="header-actions">
                <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">
                    <span id="themeIcon">ğŸŒ™</span>
                    <span id="themeText">Dark</span>
                </button>
            </div>
        </header>

        <div style="max-width: 800px; margin: 3rem auto; padding: 2rem;">
        <h1 style="font-family: 'Orbitron', monospace; text-align: center; margin-bottom: 2rem;">
            PWA Test Page
        </h1>

        <div style="background: var(--bg-secondary); padding: 2rem; border-radius: 16px; margin-bottom: 1rem;">
            <h2>Service Worker Status</h2>
            <p id="swStatus">Checking...</p>
        </div>

        <div style="background: var(--bg-secondary); padding: 2rem; border-radius: 16px; margin-bottom: 1rem;">
            <h2>PWA Support</h2>
            <p id="pwaSupport">Checking...</p>
        </div>

        <div style="background: var(--bg-secondary); padding: 2rem; border-radius: 16px; margin-bottom: 1rem;">
            <h2>Manifest Status</h2>
            <p id="manifestStatus">Checking...</p>
        </div>

        <div style="background: var(--bg-secondary); padding: 2rem; border-radius: 16px; margin-bottom: 1rem;">
            <h2>Offline Support</h2>
            <p id="offlineStatus">Checking...</p>
        </div>

        <div style="background: var(--bg-secondary); padding: 2rem; border-radius: 16px; margin-bottom: 1rem;">
            <h2>HTTPS Status</h2>
            <p id="httpsStatus">Checking...</p>
        </div>

        <div style="text-align: center; margin-top: 2rem;">
            <a href="index.php" style="display: inline-block; padding: 1rem 2rem; background: var(--accent-primary); color: white; text-decoration: none; border-radius: 8px;">
                Go to Main App
            </a>
        </div>
        </div>
    </main>

    <script>
        // Check Service Worker
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.getRegistration().then(registration => {
                if (registration) {
                    document.getElementById('swStatus').innerHTML = 'âœ… Service Worker is registered and active';
                    document.getElementById('swStatus').style.color = '#28a745';
                } else {
                    document.getElementById('swStatus').innerHTML = 'âš ï¸ Service Worker not registered. Visit index.php first.';
                    document.getElementById('swStatus').style.color = '#ffc107';
                }
            });
        } else {
            document.getElementById('swStatus').innerHTML = 'âŒ Service Worker not supported in this browser';
            document.getElementById('swStatus').style.color = '#dc3545';
        }

        // Check PWA Support
        if (window.matchMedia('(display-mode: standalone)').matches) {
            document.getElementById('pwaSupport').innerHTML = 'âœ… App is installed and running in standalone mode';
            document.getElementById('pwaSupport').style.color = '#28a745';
        } else if ('BeforeInstallPromptEvent' in window) {
            document.getElementById('pwaSupport').innerHTML = 'âœ… PWA installation supported';
            document.getElementById('pwaSupport').style.color = '#28a745';
        } else {
            document.getElementById('pwaSupport').innerHTML = 'âš ï¸ PWA installation may not be supported';
            document.getElementById('pwaSupport').style.color = '#ffc107';
        }

        // Check Manifest
        fetch('manifest.json')
            .then(response => {
                if (response.ok) {
                    document.getElementById('manifestStatus').innerHTML = 'âœ… Manifest file found and accessible';
                    document.getElementById('manifestStatus').style.color = '#28a745';
                } else {
                    document.getElementById('manifestStatus').innerHTML = 'âŒ Manifest file not found';
                    document.getElementById('manifestStatus').style.color = '#dc3545';
                }
            })
            .catch(() => {
                document.getElementById('manifestStatus').innerHTML = 'âŒ Error loading manifest';
                document.getElementById('manifestStatus').style.color = '#dc3545';
            });

        // Check Offline Support
        if ('caches' in window) {
            caches.keys().then(cacheNames => {
                if (cacheNames.length > 0) {
                    document.getElementById('offlineStatus').innerHTML = 'âœ… Offline caching enabled (' + cacheNames.length + ' cache(s))';
                    document.getElementById('offlineStatus').style.color = '#28a745';
                } else {
                    document.getElementById('offlineStatus').innerHTML = 'âš ï¸ No caches found. Visit index.php to cache files.';
                    document.getElementById('offlineStatus').style.color = '#ffc107';
                }
            });
        } else {
            document.getElementById('offlineStatus').innerHTML = 'âŒ Cache API not supported';
            document.getElementById('offlineStatus').style.color = '#dc3545';
        }

        // Check HTTPS
        if (window.location.protocol === 'https:') {
            document.getElementById('httpsStatus').innerHTML = 'âœ… Running on HTTPS (required for PWA)';
            document.getElementById('httpsStatus').style.color = '#28a745';
        } else if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
            document.getElementById('httpsStatus').innerHTML = 'âš ï¸ Running on HTTP (localhost). HTTPS required for production PWA.';
            document.getElementById('httpsStatus').style.color = '#ffc107';
        } else {
            document.getElementById('httpsStatus').innerHTML = 'âŒ Running on HTTP. HTTPS is REQUIRED for PWA features!';
            document.getElementById('httpsStatus').style.color = '#dc3545';
        }

        // Navigation
        const hamburger = document.getElementById('hamburger');
        const sidebar = document.getElementById('sidebar');
        const closeBtn = document.getElementById('closeBtn');
        const overlay = document.getElementById('overlay');
        const navLinks = document.querySelectorAll('.nav-link');

        hamburger.addEventListener('click', () => {
            sidebar.classList.add('open');
            overlay.classList.add('active');
        });

        closeBtn.addEventListener('click', () => {
            sidebar.classList.remove('open');
            overlay.classList.remove('active');
        });

        overlay.addEventListener('click', () => {
            sidebar.classList.remove('open');
            overlay.classList.remove('active');
        });

        navLinks.forEach(link => {
            link.addEventListener('click', () => {
                sidebar.classList.remove('open');
                overlay.classList.remove('active');
            });
        });

        // Theme Toggle
        const themeToggle = document.getElementById('themeToggle');
        const themeIcon = document.getElementById('themeIcon');
        const themeText = document.getElementById('themeText');

        // Load saved theme
        const savedTheme = localStorage.getItem('theme') || 'light';
        document.documentElement.setAttribute('data-theme', savedTheme);
        updateThemeButton(savedTheme);

        themeToggle.addEventListener('click', () => {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';

            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            updateThemeButton(newTheme);
        });

        function updateThemeButton(theme) {
            if (theme === 'dark') {
                themeIcon.textContent = 'â˜€ï¸';
                themeText.textContent = 'Light';
            } else {
                themeIcon.textContent = 'ğŸŒ™';
                themeText.textContent = 'Dark';
            }
        }
    </script>
</body>
</html>
